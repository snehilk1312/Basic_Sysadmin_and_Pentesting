#! /bin/bash

# CAPTURES &  ANALYZES NETWORK TRAFFIC PASSING THROUGH YOUR SYSTEM, LIKE WIRESHARK. 

# START, as root or sudo privileges

# listing all the interfaces available to capture
tcpdump -D

printf "%0.s*" {1..166}
printf "%0.s*" {1..166}

# capture all packages on any interface
tcpdump -i any

# limiting the number of package captured to 5
tcpdump -i any -c 5

# disabling name resolution
tcpdump -i any -c 5 -nn

# filtering packets by protocols
tcpdump -i any -c 5 icmp 	# ICMP packages only

# filtering packages by hosts
tcpdump -i any host 10.0.2.6

# filtering packages by sourceIp
tcpdump -i any src 10.0.2.6

# filtering package by destinationIP
tcpdump -i any dst 10.0.2.6

# filtering package by portname
tcpdump -i any port 80

# complex expressions
tcpdump -i any -c 5 src 10.0.2.6 and port 80 # more complex expression can also be given with the help of parenthesis and quotation marks

# checking packet content
tcpdump -i any -A host 10.0.2.6  # -A flag to print content in ascii , -x flag to print content in hex

# saving captures to file
tcpdump -i any -A -w webserver_tcpdump.pcap host 10.0.2.6   # to read use , # tcpdump -r webserver_tcpdump.pcap
